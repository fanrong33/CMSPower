 /*
 +----------------------------------------------------------------------------
 * dialog for jquery
 +----------------------------------------------------------------------------
 * @author fanrong33
 * @version v1.0.4 Build 20130602
 +------------------------------------------------------------------------------
 */
(function(e){function r(){this.id=0,this.options=null,this.object=null,this.template='<div class="dialog" style="width: <%=width%>px; z-index: <%=zIndex%>; display: none; position: absolute;"><div data-role="close" class="dialog-close" style="display: block;">×</div><div data-role="content" class="dialog-inner" style="background-color: #FFFFFF; height: 100%;"><%==content%></div></div>'}function i(){this.id=0,this.options=null,this.object=null,this.template='<div class="dialog" style="width: <%=width%>px; z-index: <%=zIndex%>; display: none; position: absolute;"><div data-role="close" class="dialog-close" style="display: block;">×</div><div class="dialog-inner" style="background-color: #FFFFFF; height: 100%;"><div class="dialog-hd"><%=title%></div><div class="dialog-bd"><div class="dialog-icon"><i class="iconfont">&#x21;</i></div><div class="dialog-message"><%==content%></div></div><div class="dialog-ft"><div data-role="confirm" class="dialog-confirm"><%==confirmTpl %></div><div data-role="cancel" class="dialog-cancel"><%==cancelTpl %></div></div></div></div>'}var t=!1,n=/msie/.test(navigator.userAgent.toLowerCase());e.debug=function(e){window.console&&t&&console.info(e)},r.prototype={init:function(t){e.debug("运行init方法"),this.options=t,this.id="dialog_"+(new Date).getTime(),e.debug("生成唯一ID:"+this.id);var n=this.render();this.object=e(n).attr("id",this.id),this.bindEvent()},render:function(){var e={};e.content=this.options.content,e.width=this.options.width||500,e.height=this.options.height||100,e.zIndex=this.options.zIndex||999;try{var t=template.compile(this.template),n=t(e)}catch(r){alert(r)}return n},bindEvent:function(){e.debug("绑定关闭按钮事件"),this.object.find("[data-role=close]").click(e.proxy(this.close,this)),jQuery.isFunction(this.options.onShow)&&this.options.onShow(this.object),this.object.find("[data-role=confirm]").click(e.proxy(this.options.onConfirm,this)),this.object.find("[data-role=cancel]").click(e.proxy(this.close,this))},setPosition:function(){var t=this.object.width(),n=this.object.height(),r=e(window).width(),i=e(window).height(),s=r<=t?0:(r-t)/2,o=i<=n?0:(i-n)/2;this.object.css({left:s,top:e(document).scrollTop()+o})},setMask:function(){this.options.hasMask&&(n&&"undefined"==typeof document.body.style.maxHeight?e("<div class='mask' style='position: absolute; zoom: 1;top: 0px; left: 0px; width: "+document.body.clientWidth+"px; height: "+document.body.clientHeight+"px; z-index: 998;display: block;opacity: 0.2;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=20);background-color: #000;'></div>").appendTo("body"):e("<div class='mask' style='position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 998;display: block;opacity: 0.2;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=20);background-color: #000;'></div>").appendTo("body"))},hideLoading:function(){e("#dialog_loading").fadeOut(330, function(){$(this).remove();})},showLoading:function(){e.debug("显示loading icon"),this.hideLoading();var t=e('<div id="dialog_loading"><div></div></div>').appendTo("body")},showAjax:function(t){this.object.find("[data-role=content]").html(t),e.debug("run remote success event"),jQuery.isFunction(this.options.remote.success)&&this.options.remote.success(this.object),this.options.effect=="fade"?this.object.fadeIn(220):this.object.show(),this.setPosition()},showError:function(e){alert(e.responseText)},show:function(){e.debug("运行show方法："),this.setMask(),e("#"+this.id).length==0&&(e.debug("未创建，则append to body"),this.object.appendTo("body")),this.setPosition(),this.options.remote?e.ajax({type:"GET",url:this.options.remote.url,dataType:"html",data:this.options.remote.data,beforeSend:e.proxy(this.showLoading,this),success:e.proxy(this.showAjax,this),complete:e.proxy(this.hideLoading,this),error:e.proxy(this.showError,this)}):this.options.effect=="fade"?this.object.fadeIn(220):this.object.show()},close:function(){this.options.hasMask?e("#"+this.id).prev().remove().end().remove():e("#"+this.id).remove()}},i.prototype={init:function(t){e.debug("运行init方法"),this.options=t,this.id="confirm_"+(new Date).getTime(),e.debug("生成唯一ID:"+this.id);var n=this.render();this.object=e(n).attr("id",this.id),this.bindEvent()},render:function(){var e={};e.title=this.options.title||"",e.content=this.options.content,e.width=this.options.width||450,e.zIndex=this.options.zIndex||999,e.confirmTpl=this.options.confirmTpl||'<a class="dialog-btn-orange">确定</a>',e.cancelTpl=this.options.cancelTpl||'<a class="dialog-btn-white">取消</a>';try{var t=template.compile(this.template),n=t(e)}catch(r){alert(r)}return n},bindEvent:function(){e.debug("绑定关闭按钮事件"),this.object.find("[data-role=close]").click(e.proxy(this.close,this)),this.object.find("[data-role=confirm]").click(e.proxy(this.options.onConfirm,this)),this.object.find("[data-role=cancel]").click(e.proxy(this.close,this))},setPosition:function(){var t=this.object.width(),n=this.object.height(),r=e(window).width(),i=e(window).height(),s=r<=t?0:(r-t)/2,o=i<=n?0:(i-n)/2;this.object.css({left:s,top:e(document).scrollTop()+o})},setMask:function(){this.options.hasMask&&(n&&"undefined"==typeof document.body.style.maxHeight?e("<div class='mask' style='position: absolute; zoom: 1;top: 0px; left: 0px; width: "+document.body.clientWidth+"px; height: "+document.body.clientHeight+"px; z-index: 998;display: block;opacity: 0.2;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=20);background-color: #000;'></div>").appendTo("body"):e("<div class='mask' style='position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 998;display: block;opacity: 0.2;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=20);background-color: #000;'></div>").appendTo("body"))},show:function(){e.debug("运行show方法："),this.setMask(),e("#"+this.id).length==0&&(e.debug("未创建，则append to body"),this.object.appendTo("body")),this.setPosition(),this.options.effect=="fade"?this.object.fadeIn(220):this.object.show()},close:function(){this.options.hasMask?e("#"+this.id).prev().remove().end().remove():e("#"+this.id).remove()}},e.fn.dialog=function(t){var n=e.extend({},e.fn.dialog.defaults,t);return this.each(function(){var t=e(this);t.click(function(){var e=new r;e.init(n),e.show()})})},e.fn.dialog.defaults={content:"",hasMask:!0,width:500,height:100,zIndex:999,effect:"none",onShow:function(){}},e.fn.confirm=function(t){var n=e.extend({},e.fn.dialog.defaults,t);return this.each(function(){var t=e(this);t.click(function(){var e=new i;e.init(n),e.show()})})},e.fn.confirm.defaults={title:"",content:"",confirmTpl:"",cancelTpl:"",onConfirm:function(){},hasMask:!0,width:450,zIndex:999,effect:"none"},jQuery.dialog={show:function(t){var n=e.extend({},e.fn.dialog.defaults,t),i=new r;i.init(n),i.show()},close:function(){alert("dialog close api.")}}})(jQuery);